function IsNum(sText){var ValidChars="0123456789";var IsNumber=true;var Char;if(!sText){return false;}for(i=0;i<sText.length&&IsNumber==true;i++){Char=sText.charAt(i);if(ValidChars.indexOf(Char)==-1){IsNumber=false;}}return IsNumber;}function in_array(obj,a){for(var i=0;i<a.length;i++){if(a[i]===obj){return true;}}return false;}function LooksLikeMail(str){var lastAtPos=str.lastIndexOf('@');var lastDotPos=str.lastIndexOf('.');return(lastAtPos<lastDotPos&&lastAtPos>0&&str.indexOf('@@')==-1&&lastDotPos>2&&(str.length-lastDotPos)>2);}function isArray(obj){return obj.constructor==Array;}function randomString(length){var chars='0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');if(!length){length=Math.floor(Math.random()*chars.length);}var str='';for(var i=0;i<length;i++){str+=chars[Math.floor(Math.random()*chars.length)];}return str;}function isUrl(s){if(s){var regexp='/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)? (\/|\/([\w#!:.?+=&%@!\-\/]))?/';return regexp.test(s);}else{return false;}}function InitBlockBox(inZIndex){var Id=randomString(5);var div='<div id="'+Id+'" class="blockBox"></div>';if(!(inZIndex)){inZIndex='1';}$('body').append(div);$('#'+Id).css('display','block');$('#'+Id).css('background-color','#ffffff');$('#'+Id).css('position','absolute');$('#'+Id).css('top','0');$('#'+Id).css('bottom','0');$('#'+Id).css('left','0');$('#'+Id).css('right','0');$('#'+Id).css('z-index',inZIndex);$('#'+Id).css({opacity:0.8});}function getURLParameter(name){return decodeURI((RegExp(name+'='+'(.+?)(&|$)').exec(location.search)||[,null])[1]);}function implode(glue,pieces){return((pieces instanceof Array)?pieces.join(glue):pieces);}function GetURLParameter(sParam){var sPageURL=window.location.search.substring(1);var sURLVariables=sPageURL.split('&');for(var i=0;i<sURLVariables.length;i++){var sParameterName=sURLVariables[i].split('=');if(sParameterName[0]==sParam){return sParameterName[1];}}}function GetAllUrlParams(){var result=new Array();var split=window.location.search.replace('?','').split('&').map(function(val){var temp=val.split('=');result[temp[0]]=temp[1];});return result;}function GetPathFromUrl(url){return url.split("?")[0];}String.prototype.replaceAll=function(search,replace){return this.split(search).join(replace);}
function CleanWord(html){html=html.replace(/<o:p>/g,"");html=html.replace(/<\/o:p>/g,"");html=html.replace(/\s*mso-[^:]+:[^;"]+;?/gi,"");html=html.replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,"");html=html.replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,"\"");html=html.replace(/\s*TEXT-INDENT: 0cm\s*;/gi,"");html=html.replace(/\s*TEXT-INDENT: 0cm\s*"/gi,"\"");html=html.replace(/\s*TEXT-ALIGN: [^\s;]+;?"/gi,"\"");html=html.replace(/\s*PAGE-BREAK-BEFORE: [^\s;]+;?"/gi,"\"");html=html.replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,"\"");html=html.replace(/\s*tab-stops:[^;"]*;?/gi,"");html=html.replace(/\s*tab-stops:[^"]*/gi,"");html=html.replace(/\s*face="[^"]*"/gi,"");html=html.replace(/\s*face=[^ >]*/gi,"");html=html.replace(/\s*FONT-FAMILY:[^;"]*;?/gi,"");html=html.replace(/<FONT\s*>(.*?)<\/FONT>/gi,"$1");html=html.replace(/\s*size="[^"]*"/gi,"");html=html.replace(/\s*size=[^ >]*([ >])/gi,"$1");html=html.replace(/<FONT\s*>(.*?)<\/FONT>/gi,"$1");html=html.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3");html=html.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gi,"<$1$3");html=html.replace(/\s*style="\s*"/gi,'');html=html.replace(/<SPAN\s*[^>]*>\s*&nbsp;\s*<\/SPAN>/gi,'&nbsp;');html=html.replace(/<SPAN\s*[^>]*><\/SPAN>/gi,'');html=html.replace(/<PRE\s*[^>]*>\s*&nbsp;\s*<\/PRE>/gi,'&nbsp;');html=html.replace(/<PRE\s*[^>]*><\/PRE>/gi,'');html=html.replace(/<EM\s*[^>]*>\s*&nbsp;\s*<\/EM>/gi,'&nbsp;');html=html.replace(/<EM\s*[^>]*><\/EM>/gi,'');html=html.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3");html=html.replace(/<\\?\?xml[^>]*>/gi,"");html=html.replace(/<\/?\w+:[^>]*>/gi,"");html=html.replace(/<\!--.*-->/g,"");html=html.replace(/<(U|I|STRIKE)>&nbsp;<\/\1>/g,'&nbsp;');html=html.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,'');html=html.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,'');html=html.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,'');html=html.replace(/<SPAN\s*>(.*?)<\/SPAN>/gi,'$1');re=new RegExp(window.location+"#","g");html=html.replace(re,'#');$(html).find("p:empty").remove();return html;}function GetDiffDate(inStartDate,inEndDate){var beginDate=inStartDate;var beginDateAr=beginDate.split('-');var endDate=inEndDate;var endDateAr=endDate.split('-');var bDate=new Date($.trim(beginDateAr[2]),$.trim(beginDateAr[1]),$.trim(beginDateAr[0]),0,0,0);var eDate=new Date($.trim(endDateAr[2]),$.trim(endDateAr[1]),$.trim(endDateAr[0]),0,0,0);var result=((eDate-bDate)/(1000*60*60*24));result=Math.round(result);if(beginDateAr[1]!=endDateAr[1]){result=Math.round(result)-1;}if(result>0){return result;}else{return false;}}